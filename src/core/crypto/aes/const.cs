// Copyright 2009 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

// Package aes implements AES encryption (formerly Rijndael), as defined in
// U.S. Federal Information Processing Standards Publication 197.
//
// The AES operations in this package are not implemented using constant-time algorithms.
// An exception is when running on systems with enabled hardware support for AES
// that makes these operations constant-time. Examples include amd64 systems using AES-NI
// extensions and s390x systems using Message-Security-Assist extensions.
// On such systems, when the result of NewCipher is passed to cipher.NewGCM,
// the GHASH operation used by GCM is also constant-time.
namespace go.crypto;

partial class aes_package {

// This file contains AES constants - 8720 bytes of initialized data.
// https://csrc.nist.gov/publications/fips/fips197/fips-197.pdf

// AES is based on the mathematical behavior of binary polynomials
// (polynomials over GF(2)) modulo the irreducible polynomial x⁸ + x⁴ + x³ + x + 1.
// Addition of these binary polynomials corresponds to binary xor.
// Reducing mod poly corresponds to binary xor with poly every
// time a 0x100 bit appears.
internal static readonly UntypedInt poly = /* 1<<8 | 1<<4 | 1<<3 | 1<<1 | 1<<0 */ 283; // x⁸ + x⁴ + x³ + x + 1

// Powers of x mod poly in GF(2).
internal static array<byte> powx = new byte[]{
    1,
    2,
    4,
    8,
    16,
    32,
    64,
    128,
    27,
    54,
    108,
    216,
    171,
    77,
    154,
    47
}.array();

// FIPS-197 Figure 7. S-box substitution values in hexadecimal format.
internal static array<byte> sbox0 = new byte[]{
    99, 124, 119, 123, 242, 107, 111, 197, 48, 1, 103, 43, 254, 215, 171, 118,
    202, 130, 201, 125, 250, 89, 71, 240, 173, 212, 162, 175, 156, 164, 114, 192,
    183, 253, 147, 38, 54, 63, 247, 204, 52, 165, 229, 241, 113, 216, 49, 21,
    4, 199, 35, 195, 24, 150, 5, 154, 7, 18, 128, 226, 235, 39, 178, 117,
    9, 131, 44, 26, 27, 110, 90, 160, 82, 59, 214, 179, 41, 227, 47, 132,
    83, 209, 0, 237, 32, 252, 177, 91, 106, 203, 190, 57, 74, 76, 88, 207,
    208, 239, 170, 251, 67, 77, 51, 133, 69, 249, 2, 127, 80, 60, 159, 168,
    81, 163, 64, 143, 146, 157, 56, 245, 188, 182, 218, 33, 16, 255, 243, 210,
    205, 12, 19, 236, 95, 151, 68, 23, 196, 167, 126, 61, 100, 93, 25, 115,
    96, 129, 79, 220, 34, 42, 144, 136, 70, 238, 184, 20, 222, 94, 11, 219,
    224, 50, 58, 10, 73, 6, 36, 92, 194, 211, 172, 98, 145, 149, 228, 121,
    231, 200, 55, 109, 141, 213, 78, 169, 108, 86, 244, 234, 101, 122, 174, 8,
    186, 120, 37, 46, 28, 166, 180, 198, 232, 221, 116, 31, 75, 189, 139, 138,
    112, 62, 181, 102, 72, 3, 246, 14, 97, 53, 87, 185, 134, 193, 29, 158,
    225, 248, 152, 17, 105, 217, 142, 148, 155, 30, 135, 233, 206, 85, 40, 223,
    140, 161, 137, 13, 191, 230, 66, 104, 65, 153, 45, 15, 176, 84, 187, 22
}.array();

// FIPS-197 Figure 14.  Inverse S-box substitution values in hexadecimal format.
internal static array<byte> sbox1 = new byte[]{
    82, 9, 106, 213, 48, 54, 165, 56, 191, 64, 163, 158, 129, 243, 215, 251,
    124, 227, 57, 130, 155, 47, 255, 135, 52, 142, 67, 68, 196, 222, 233, 203,
    84, 123, 148, 50, 166, 194, 35, 61, 238, 76, 149, 11, 66, 250, 195, 78,
    8, 46, 161, 102, 40, 217, 36, 178, 118, 91, 162, 73, 109, 139, 209, 37,
    114, 248, 246, 100, 134, 104, 152, 22, 212, 164, 92, 204, 93, 101, 182, 146,
    108, 112, 72, 80, 253, 237, 185, 218, 94, 21, 70, 87, 167, 141, 157, 132,
    144, 216, 171, 0, 140, 188, 211, 10, 247, 228, 88, 5, 184, 179, 69, 6,
    208, 44, 30, 143, 202, 63, 15, 2, 193, 175, 189, 3, 1, 19, 138, 107,
    58, 145, 17, 65, 79, 103, 220, 234, 151, 242, 207, 206, 240, 180, 230, 115,
    150, 172, 116, 34, 231, 173, 53, 133, 226, 249, 55, 232, 28, 117, 223, 110,
    71, 241, 26, 113, 29, 41, 197, 137, 111, 183, 98, 14, 170, 24, 190, 27,
    252, 86, 62, 75, 198, 210, 121, 32, 154, 219, 192, 254, 120, 205, 90, 244,
    31, 221, 168, 51, 136, 7, 199, 49, 177, 18, 16, 89, 39, 128, 236, 95,
    96, 81, 127, 169, 25, 181, 74, 13, 45, 229, 122, 159, 147, 201, 156, 239,
    160, 224, 59, 77, 174, 42, 245, 176, 200, 235, 187, 60, 131, 83, 153, 97,
    23, 43, 4, 126, 186, 119, 214, 38, 225, 105, 20, 99, 85, 33, 12, 125
}.array();

// Lookup tables for encryption.
// These can be recomputed by adapting the tests in aes_test.go.
internal static array<uint32> te0 = new uint32[]{
    (nint)3328402341L, (nint)4168907908L, (nint)4000806809L, (nint)4135287693L, (nint)4294111757L, (nint)3597364157L, (nint)3731845041L, (nint)2445657428L,
    1613770832, 33620227, (nint)3462883241L, 1445669757, (nint)3892248089L, (nint)3050821474L, 1303096294, (nint)3967186586L,
    (nint)2412431941L, 528646813, (nint)2311702848L, (nint)4202528135L, (nint)4026202645L, (nint)2992200171L, (nint)2387036105L, (nint)4226871307L,
    1101901292, (nint)3017069671L, 1604494077, 1169141738, 597466303, 1403299063, (nint)3832705686L, (nint)2613100635L,
    1974974402, (nint)3791519004L, 1033081774, 1277568618, 1815492186, 2118074177, (nint)4126668546L, (nint)2211236943L,
    1748251740, 1369810420, (nint)3521504564L, (nint)4193382664L, (nint)3799085459L, (nint)2883115123L, 1647391059, 706024767,
    134480908, (nint)2512897874L, 1176707941, (nint)2646852446L, 806885416, 932615841, 168101135, 798661301,
    235341577, 605164086, 461406363, (nint)3756188221L, (nint)3454790438L, 1311188841, 2142417613, (nint)3933566367L,
    302582043, 495158174, 1479289972, 874125870, 907746093, (nint)3698224818L, (nint)3025820398L, 1537253627,
    (nint)2756858614L, 1983593293, (nint)3084310113L, 2108928974, 1378429307, (nint)3722699582L, 1580150641, 327451799,
    (nint)2790478837L, (nint)3117535592L, 0, (nint)3253595436L, 1075847264, (nint)3825007647L, 2041688520, (nint)3059440621L,
    (nint)3563743934L, (nint)2378943302L, 1740553945, 1916352843, (nint)2487896798L, (nint)2555137236L, (nint)2958579944L, (nint)2244988746L,
    (nint)3151024235L, (nint)3320835882L, 1336584933, (nint)3992714006L, (nint)2252555205L, (nint)2588757463L, 1714631509, 293963156,
    (nint)2319795663L, (nint)3925473552L, 67240454, (nint)4269768577L, (nint)2689618160L, 2017213508, 631218106, 1269344483,
    (nint)2723238387L, 1571005438, (nint)2151694528L, 93294474, 1066570413, 563977660, 1882732616, (nint)4059428100L,
    1673313503, 2008463041, (nint)2950355573L, 1109467491, 537923632, (nint)3858759450L, (nint)4260623118L, (nint)3218264685L,
    (nint)2177748300L, 403442708, 638784309, (nint)3287084079L, (nint)3193921505L, 899127202, (nint)2286175436L, 773265209,
    (nint)2479146071L, 1437050866, (nint)4236148354L, 2050833735, (nint)3362022572L, (nint)3126681063L, 840505643, (nint)3866325909L,
    (nint)3227541664L, 427917720, (nint)2655997905L, (nint)2749160575L, 1143087718, 1412049534, 999329963, 193497219,
    (nint)2353415882L, (nint)3354324521L, 1807268051, 672404540, (nint)2816401017L, (nint)3160301282L, 369822493, (nint)2916866934L,
    (nint)3688947771L, 1681011286, 1949973070, 336202270, (nint)2454276571L, 201721354, 1210328172, (nint)3093060836L,
    (nint)2680341085L, (nint)3184776046L, 1135389935, (nint)3294782118L, 965841320, 831886756, (nint)3554993207L, (nint)4068047243L,
    (nint)3588745010L, (nint)2345191491L, 1849112409, (nint)3664604599L, 26054028, (nint)2983581028L, (nint)2622377682L, 1235855840,
    (nint)3630984372L, (nint)2891339514L, (nint)4092916743L, (nint)3488279077L, (nint)3395642799L, (nint)4101667470L, 1202630377, 268961816,
    1874508501, (nint)4034427016L, 1243948399, 1546530418, 941366308, 1470539505, 1941222599, (nint)2546386513L,
    (nint)3421038627L, (nint)2715671932L, (nint)3899946140L, 1042226977, (nint)2521517021L, 1639824860, 227249030, 260737669,
    (nint)3765465232L, 2084453954, 1907733956, (nint)3429263018L, (nint)2420656344L, 100860677, (nint)4160157185L, 470683154,
    (nint)3261161891L, 1781871967, (nint)2924959737L, 1773779408, 394692241, (nint)2579611992L, 974986535, 664706745,
    (nint)3655459128L, (nint)3958962195L, 731420851, 571543859, (nint)3530123707L, (nint)2849626480L, 126783113, 865375399,
    765172662, 1008606754, 361203602, (nint)3387549984L, (nint)2278477385L, (nint)2857719295L, 1344809080, (nint)2782912378L,
    59542671, 1503764984, 160008576, 437062935, 1707065306, (nint)3622233649L, (nint)2218934982L, (nint)3496503480L,
    (nint)2185314755L, 697932208, 1512910199, 504303377, 2075177163, (nint)2824099068L, 1841019862, 739644986
}.array();

internal static array<uint32> te1 = new uint32[]{
    (nint)2781242211L, (nint)2230877308L, (nint)2582542199L, (nint)2381740923L, 234877682, (nint)3184946027L, (nint)2984144751L, 1418839493,
    1348481072, 50462977, (nint)2848876391L, 2102799147, 434634494, 1656084439, (nint)3863849899L, (nint)2599188086L,
    1167051466, (nint)2636087938L, 1082771913, (nint)2281340285L, 368048890, (nint)3954334041L, (nint)3381544775L, 201060592,
    (nint)3963727277L, 1739838676, (nint)4250903202L, (nint)3930435503L, (nint)3206782108L, (nint)4149453988L, (nint)2531553906L, 1536934080,
    (nint)3262494647L, 484572669, (nint)2923271059L, 1783375398, 1517041206, 1098792767, 49674231, 1334037708,
    1550332980, (nint)4098991525L, 886171109, 150598129, (nint)2481090929L, 1940642008, 1398944049, 1059722517,
    201851908, 1385547719, 1699095331, 1587397571, 674240536, (nint)2704774806L, 252314885, (nint)3039795866L,
    151914247, 908333586, (nint)2602270848L, 1038082786, 651029483, 1766729511, (nint)3447698098L, (nint)2682942837L,
    454166793, (nint)2652734339L, 1951935532, 775166490, 758520603, (nint)3000790638L, (nint)4004797018L, (nint)4217086112L,
    (nint)4137964114L, 1299594043, 1639438038, (nint)3464344499L, 2068982057, 1054729187, 1901997871, (nint)2534638724L,
    (nint)4121318227L, 1757008337, 0, 750906861, 1614815264, 535035132, (nint)3363418545L, (nint)3988151131L,
    (nint)3201591914L, 1183697867, (nint)3647454910L, 1265776953, (nint)3734260298L, (nint)3566750796L, (nint)3903871064L, 1250283471,
    1807470800, 717615087, (nint)3847203498L, 384695291, (nint)3313910595L, (nint)3617213773L, 1432761139, (nint)2484176261L,
    (nint)3481945413L, 283769337, 100925954, (nint)2180939647L, (nint)4037038160L, 1148730428, (nint)3123027871L, (nint)3813386408L,
    (nint)4087501137L, (nint)4267549603L, (nint)3229630528L, (nint)2315620239L, (nint)2906624658L, (nint)3156319645L, 1215313976, 82966005,
    (nint)3747855548L, (nint)3245848246L, 1974459098, 1665278241, 807407632, 451280895, 251524083, 1841287890,
    1283575245, 337120268, 891687699, 801369324, (nint)3787349855L, (nint)2721421207L, (nint)3431482436L, 959321879,
    1469301956, (nint)4065699751L, (nint)2197585534L, 1199193405, (nint)2898814052L, (nint)3887750493L, 724703513, (nint)2514908019L,
    (nint)2696962144L, (nint)2551808385L, (nint)3516813135L, 2141445340, 1715741218, 2119445034, (nint)2872807568L, (nint)2198571144L,
    (nint)3398190662L, 700968686, (nint)3547052216L, 1009259540, 2041044702, (nint)3803995742L, 487983883, 1991105499,
    1004265696, 1449407026, 1316239930, 504629770, (nint)3683797321L, 168560134, 1816667172, (nint)3837287516L,
    1570751170, 1857934291, (nint)4014189740L, (nint)2797888098L, (nint)2822345105L, (nint)2754712981L, 936633572, (nint)2347923833L,
    852879335, 1133234376, 1500395319, (nint)3084545389L, (nint)2348912013L, 1689376213, (nint)3533459022L, (nint)3762923945L,
    (nint)3034082412L, (nint)4205598294L, 133428468, 634383082, (nint)2949277029L, (nint)2398386810L, (nint)3913789102L, 403703816,
    (nint)3580869306L, (nint)2297460856L, 1867130149, 1918643758, 607656988, (nint)4049053350L, (nint)3346248884L, 1368901318,
    600565992, 2090982877, (nint)2632479860L, 557719327, (nint)3717614411L, (nint)3697393085L, (nint)2249034635L, (nint)2232388234L,
    (nint)2430627952L, 1115438654, (nint)3295786421L, (nint)2865522278L, (nint)3633334344L, 84280067, 33027830, 303828494,
    (nint)2747425121L, 1600795957, (nint)4188952407L, (nint)3496589753L, (nint)2434238086L, 1486471617, 658119965, (nint)3106381470L,
    953803233, 334231800, (nint)3005978776L, 857870609, (nint)3151128937L, 1890179545, (nint)2298973838L, (nint)2805175444L,
    (nint)3056442267L, 574365214, (nint)2450884487L, 550103529, 1233637070, (nint)4289353045L, 2018519080, 2057691103,
    (nint)2399374476L, (nint)4166623649L, (nint)2148108681L, 387583245, (nint)3664101311L, 836232934, (nint)3330556482L, (nint)3100665960L,
    (nint)3280093505L, (nint)2955516313L, 2002398509, 287182607, (nint)3413881008L, (nint)4238890068L, (nint)3597515707L, 975967766
}.array();

internal static array<uint32> te2 = new uint32[]{
    1671808611, 2089089148, 2006576759, 2072901243, (nint)4061003762L, 1807603307, 1873927791, (nint)3310653893L,
    810573872, 16974337, 1739181671, 729634347, (nint)4263110654L, (nint)3613570519L, (nint)2883997099L, 1989864566,
    (nint)3393556426L, (nint)2191335298L, (nint)3376449993L, 2106063485, (nint)4195741690L, 1508618841, 1204391495, (nint)4027317232L,
    (nint)2917941677L, (nint)3563566036L, (nint)2734514082L, (nint)2951366063L, (nint)2629772188L, (nint)2767672228L, 1922491506, (nint)3227229120L,
    (nint)3082974647L, (nint)4246528509L, (nint)2477669779L, 644500518, 911895606, 1061256767, (nint)4144166391L, (nint)3427763148L,
    878471220, (nint)2784252325L, (nint)3845444069L, (nint)4043897329L, 1905517169, (nint)3631459288L, 827548209, 356461077,
    67897348, (nint)3344078279L, 593839651, (nint)3277757891L, 405286936, (nint)2527147926L, 84871685, (nint)2595565466L,
    118033927, 305538066, (nint)2157648768L, (nint)3795705826L, (nint)3945188843L, 661212711, (nint)2999812018L, 1973414517,
    152769033, (nint)2208177539L, 745822252, 439235610, 455947803, 1857215598, 1525593178, (nint)2700827552L,
    1391895634, 994932283, (nint)3596728278L, (nint)3016654259L, 695947817, (nint)3812548067L, 795958831, (nint)2224493444L,
    1408607827, (nint)3513301457L, 0, (nint)3979133421L, 543178784, (nint)4229948412L, (nint)2982705585L, 1542305371,
    1790891114, (nint)3410398667L, (nint)3201918910L, 961245753, 1256100938, 1289001036, 1491644504, (nint)3477767631L,
    (nint)3496721360L, (nint)4012557807L, (nint)2867154858L, (nint)4212583931L, 1137018435, 1305975373, 861234739, (nint)2241073541L,
    1171229253, (nint)4178635257L, 33948674, 2139225727, 1357946960, 1011120188, (nint)2679776671L, (nint)2833468328L,
    1374921297, (nint)2751356323L, 1086357568, (nint)2408187279L, (nint)2460827538L, (nint)2646352285L, 944271416, (nint)4110742005L,
    (nint)3168756668L, (nint)3066132406L, (nint)3665145818L, 560153121, 271589392, (nint)4279952895L, (nint)4077846003L, (nint)3530407890L,
    (nint)3444343245L, 202643468, 322250259, (nint)3962553324L, 1608629855, (nint)2543990167L, 1154254916, 389623319,
    (nint)3294073796L, (nint)2817676711L, 2122513534, 1028094525, 1689045092, 1575467613, 422261273, 1939203699,
    1621147744, (nint)2174228865L, 1339137615, (nint)3699352540L, 577127458, 712922154, (nint)2427141008L, (nint)2290289544L,
    1187679302, (nint)3995715566L, (nint)3100863416L, 339486740, (nint)3732514782L, 1591917662, 186455563, (nint)3681988059L,
    (nint)3762019296L, 844522546, 978220090, 169743370, 1239126601, 101321734, 611076132, 1558493276,
    (nint)3260915650L, (nint)3547250131L, (nint)2901361580L, 1655096418, (nint)2443721105L, (nint)2510565781L, (nint)3828863972L, 2039214713,
    (nint)3878868455L, (nint)3359869896L, 928607799, 1840765549, (nint)2374762893L, (nint)3580146133L, 1322425422, (nint)2850048425L,
    1823791212, 1459268694, (nint)4094161908L, (nint)3928346602L, 1706019429, 2056189050, (nint)2934523822L, 135794696,
    (nint)3134549946L, 2022240376, 628050469, 779246638, 472135708, (nint)2800834470L, (nint)3032970164L, (nint)3327236038L,
    (nint)3894660072L, (nint)3715932637L, 1956440180, 522272287, 1272813131, (nint)3185336765L, (nint)2340818315L, (nint)2323976074L,
    1888542832, 1044544574, (nint)3049550261L, 1722469478, 1222152264, 50660867, (nint)4127324150L, 236067854,
    1638122081, 895445557, 1475980887, (nint)3117443513L, (nint)2257655686L, (nint)3243809217L, 489110045, (nint)2662934430L,
    (nint)3778599393L, (nint)4162055160L, (nint)2561878936L, 288563729, 1773916777, (nint)3648039385L, (nint)2391345038L, (nint)2493985684L,
    (nint)2612407707L, 505560094, (nint)2274497927L, (nint)3911240169L, (nint)3460925390L, 1442818645, 678973480, (nint)3749357023L,
    (nint)2358182796L, (nint)2717407649L, (nint)2306869641L, 219617805, (nint)3218761151L, (nint)3862026214L, 1120306242, 1756942440,
    1103331905, (nint)2578459033L, 762796589, 252780047, (nint)2966125488L, 1425844308, (nint)3151392187L, 372911126
}.array();

internal static array<uint32> te3 = new uint32[]{
    1667474886, 2088535288, 2004326894, 2071694838, (nint)4075949567L, 1802223062, 1869591006, (nint)3318043793L,
    808472672, 16843522, 1734846926, 724270422, (nint)4278065639L, (nint)3621216949L, (nint)2880169549L, 1987484396,
    (nint)3402253711L, (nint)2189597983L, (nint)3385409673L, 2105378810, (nint)4210693615L, 1499065266, 1195886990, (nint)4042263547L,
    (nint)2913856577L, (nint)3570689971L, (nint)2728590687L, (nint)2947541573L, (nint)2627518243L, (nint)2762274643L, 1920112356, (nint)3233831835L,
    (nint)3082273397L, (nint)4261223649L, (nint)2475929149L, 640051788, 909531756, 1061110142, (nint)4160160501L, (nint)3435941763L,
    875846760, (nint)2779116625L, (nint)3857003729L, (nint)4059105529L, 1903268834, (nint)3638064043L, 825316194, 353713962,
    67374088, (nint)3351728789L, 589522246, (nint)3284360861L, 404236336, (nint)2526454071L, 84217610, (nint)2593830191L,
    117901582, 303183396, (nint)2155911963L, (nint)3806477791L, (nint)3958056653L, 656894286, (nint)2998062463L, 1970642922,
    151591698, (nint)2206440989L, 741110872, 437923380, 454765878, 1852748508, 1515908788, (nint)2694904667L,
    1381168804, 993742198, (nint)3604373943L, (nint)3014905469L, 690584402, (nint)3823320797L, 791638366, (nint)2223281939L,
    1398011302, (nint)3520161977L, 0, (nint)3991743681L, 538992704, (nint)4244381667L, (nint)2981218425L, 1532751286,
    1785380564, (nint)3419096717L, (nint)3200178535L, 960056178, 1246420628, 1280103576, 1482221744, (nint)3486468741L,
    (nint)3503319995L, (nint)4025428677L, (nint)2863326543L, (nint)4227536621L, 1128514950, 1296947098, 859002214, (nint)2240123921L,
    1162203018, (nint)4193849577L, 33687044, 2139062782, 1347481760, 1010582648, (nint)2678045221L, (nint)2829640523L,
    1364325282, (nint)2745433693L, 1077985408, (nint)2408548869L, (nint)2459086143L, (nint)2644360225L, 943212656, (nint)4126475505L,
    (nint)3166494563L, (nint)3065430391L, (nint)3671750063L, 555836226, 269496352, (nint)4294908645L, (nint)4092792573L, (nint)3537006015L,
    (nint)3452783745L, 202118168, 320025894, (nint)3974901699L, 1600119230, (nint)2543297077L, 1145359496, 387397934,
    (nint)3301201811L, (nint)2812801621L, 2122220284, 1027426170, 1684319432, 1566435258, 421079858, 1936954854,
    1616945344, (nint)2172753945L, 1330631070, (nint)3705438115L, 572679748, 707427924, (nint)2425400123L, (nint)2290647819L,
    1179044492, (nint)4008585671L, (nint)3099120491L, 336870440, (nint)3739122087L, 1583276732, 185277718, (nint)3688593069L,
    (nint)3772791771L, 842159716, 976899700, 168435220, 1229577106, 101059084, 606366792, 1549591736,
    (nint)3267517855L, (nint)3553849021L, (nint)2897014595L, 1650632388, (nint)2442242105L, (nint)2509612081L, (nint)3840161747L, 2038008818,
    (nint)3890688725L, (nint)3368567691L, 926374254, 1835907034, (nint)2374863873L, (nint)3587531953L, 1313788572, (nint)2846482505L,
    1819063512, 1448540844, (nint)4109633523L, (nint)3941213647L, 1701162954, 2054852340, (nint)2930698567L, 134748176,
    (nint)3132806511L, 2021165296, 623210314, 774795868, 471606328, (nint)2795958615L, (nint)3031746419L, (nint)3334885783L,
    (nint)3907527627L, (nint)3722280097L, 1953799400, 522133822, 1263263126, (nint)3183336545L, (nint)2341176845L, (nint)2324333839L,
    1886425312, 1044267644, (nint)3048588401L, 1718004428, 1212733584, 50529542, (nint)4143317495L, 235803164,
    1633788866, 892690282, 1465383342, (nint)3115962473L, (nint)2256965911L, (nint)3250673817L, 488449850, (nint)2661202215L,
    (nint)3789633753L, (nint)4177007595L, (nint)2560144171L, 286339874, 1768537042, (nint)3654906025L, (nint)2391705863L, (nint)2492770099L,
    (nint)2610673197L, 505291324, (nint)2273808917L, (nint)3924369609L, (nint)3469625735L, 1431699370, 673740880, (nint)3755965093L,
    (nint)2358021891L, (nint)2711746649L, (nint)2307489801L, 218961690, (nint)3217021541L, (nint)3873845719L, 1111672452, 1751693520,
    1094828930, (nint)2576986153L, 757954394, 252645662, (nint)2964376443L, 1414855848, (nint)3149649517L, 370555436
}.array();

// Lookup tables for decryption.
// These can be recomputed by adapting the tests in aes_test.go.
internal static array<uint32> td0 = new uint32[]{
    1374988112, 2118214995, 437757123, 975658646, 1001089995, 530400753, (nint)2902087851L, 1273168787,
    540080725, (nint)2910219766L, (nint)2295101073L, (nint)4110568485L, 1340463100, (nint)3307916247L, 641025152, (nint)3043140495L,
    (nint)3736164937L, 632953703, 1172967064, 1576976609, (nint)3274667266L, (nint)2169303058L, (nint)2370213795L, 1809054150,
    59727847, 361929877, (nint)3211623147L, (nint)2505202138L, (nint)3569255213L, 1484005843, 1239443753, (nint)2395588676L,
    1975683434, (nint)4102977912L, (nint)2572697195L, 666464733, (nint)3202437046L, (nint)4035489047L, (nint)3374361702L, 2110667444,
    1675577880, (nint)3843699074L, (nint)2538681184L, 1649639237, (nint)2976151520L, (nint)3144396420L, (nint)4269907996L, (nint)4178062228L,
    1883793496, (nint)2403728665L, (nint)2497604743L, 1383856311, (nint)2876494627L, 1917518562, (nint)3810496343L, 1716890410,
    (nint)3001755655L, 800440835, (nint)2261089178L, (nint)3543599269L, 807962610, 599762354, 33778362, (nint)3977675356L,
    (nint)2328828971L, (nint)2809771154L, (nint)4077384432L, 1315562145, 1708848333, 101039829, (nint)3509871135L, (nint)3299278474L,
    875451293, (nint)2733856160L, 92987698, (nint)2767645557L, 193195065, 1080094634, 1584504582, (nint)3178106961L,
    1042385657, (nint)2531067453L, (nint)3711829422L, 1306967366, (nint)2438237621L, 1908694277, 67556463, 1615861247,
    429456164, (nint)3602770327L, (nint)2302690252L, 1742315127, (nint)2968011453L, 126454664, (nint)3877198648L, 2043211483,
    (nint)2709260871L, 2084704233, (nint)4169408201L, 0, 159417987, 841739592, 504459436, 1817866830,
    (nint)4245618683L, 260388950, 1034867998, 908933415, 168810852, 1750902305, (nint)2606453969L, 607530554,
    202008497, (nint)2472011535L, (nint)3035535058L, 463180190, (nint)2160117071L, 1641816226, 1517767529, 470948374,
    (nint)3801332234L, (nint)3231722213L, 1008918595, 303765277, 235474187, (nint)4069246893L, 766945465, 337553864,
    1475418501, (nint)2943682380L, (nint)4003061179L, (nint)2743034109L, (nint)4144047775L, 1551037884, 1147550661, 1543208500,
    (nint)2336434550L, (nint)3408119516L, (nint)3069049960L, (nint)3102011747L, (nint)3610369226L, 1113818384, 328671808, (nint)2227573024L,
    (nint)2236228733L, (nint)3535486456L, (nint)2935566865L, (nint)3341394285L, 496906059, (nint)3702665459L, 226906860, 2009195472,
    733156972, (nint)2842737049L, 294930682, 1206477858, (nint)2835123396L, (nint)2700099354L, 1451044056, 573804783,
    (nint)2269728455L, (nint)3644379585L, (nint)2362090238L, (nint)2564033334L, (nint)2801107407L, (nint)2776292904L, (nint)3669462566L, 1068351396,
    742039012, 1350078989, 1784663195, 1417561698, (nint)4136440770L, (nint)2430122216L, 775550814, (nint)2193862645L,
    (nint)2673705150L, 1775276924, 1876241833, (nint)3475313331L, (nint)3366754619L, 270040487, (nint)3902563182L, (nint)3678124923L,
    (nint)3441850377L, 1851332852, (nint)3969562369L, (nint)2203032232L, (nint)3868552805L, (nint)2868897406L, 566021896, (nint)4011190502L,
    (nint)3135740889L, 1248802510, (nint)3936291284L, 699432150, 832877231, 708780849, (nint)3332740144L, 899835584,
    1951317047, (nint)4236429990L, (nint)3767586992L, 866637845, (nint)4043610186L, 1106041591, 2144161806, 395441711,
    1984812685, 1139781709, (nint)3433712980L, (nint)3835036895L, (nint)2664543715L, 1282050075, (nint)3240894392L, 1181045119,
    (nint)2640243204L, 25965917, (nint)4203181171L, (nint)4211818798L, (nint)3009879386L, (nint)2463879762L, (nint)3910161971L, 1842759443,
    (nint)2597806476L, 933301370, 1509430414, (nint)3943906441L, (nint)3467192302L, (nint)3076639029L, (nint)3776767469L, 2051518780,
    (nint)2631065433L, 1441952575, 404016761, 1942435775, 1408749034, 1610459739, (nint)3745345300L, 2017778566,
    (nint)3400528769L, (nint)3110650942L, 941896748, (nint)3265478751L, 371049330, (nint)3168937228L, 675039627, (nint)4279080257L,
    967311729, 135050206, (nint)3635733660L, 1683407248, 2076935265, (nint)3576870512L, 1215061108, (nint)3501741890L
}.array();

internal static array<uint32> td1 = new uint32[]{
    1347548327, 1400783205, (nint)3273267108L, (nint)2520393566L, (nint)3409685355L, (nint)4045380933L, (nint)2880240216L, (nint)2471224067L,
    1428173050, (nint)4138563181L, (nint)2441661558L, 636813900, (nint)4233094615L, (nint)3620022987L, (nint)2149987652L, (nint)2411029155L,
    1239331162, 1730525723, (nint)2554718734L, (nint)3781033664L, 46346101, 310463728, (nint)2743944855L, (nint)3328955385L,
    (nint)3875770207L, (nint)2501218972L, (nint)3955191162L, (nint)3667219033L, 768917123, (nint)3545789473L, 692707433, 1150208456,
    1786102409, 2029293177, 1805211710, (nint)3710368113L, (nint)3065962831L, 401639597, 1724457132, (nint)3028143674L,
    409198410, (nint)2196052529L, 1620529459, 1164071807, (nint)3769721975L, (nint)2226875310L, 486441376, (nint)2499348523L,
    1483753576, 428819965, (nint)2274680428L, (nint)3075636216L, 598438867, (nint)3799141122L, 1474502543, 711349675,
    129166120, 53458370, (nint)2592523643L, (nint)2782082824L, (nint)4063242375L, (nint)2988687269L, (nint)3120694122L, 1559041666,
    730517276, (nint)2460449204L, (nint)4042459122L, (nint)2706270690L, (nint)3446004468L, (nint)3573941694L, 533804130, (nint)2328143614L,
    (nint)2637442643L, (nint)2695033685L, 839224033, 1973745387, 957055980, (nint)2856345839L, 106852767, 1371368976,
    (nint)4181598602L, 1033297158, (nint)2933734917L, 1179510461, (nint)3046200461L, 91341917, 1862534868, (nint)4284502037L,
    605657339, (nint)2547432937L, (nint)3431546947L, 2003294622, (nint)3182487618L, (nint)2282195339L, 954669403, (nint)3682191598L,
    1201765386, (nint)3917234703L, (nint)3388507166L, 0, (nint)2198438022L, 1211247597, (nint)2887651696L, 1315723890,
    (nint)4227665663L, 1443857720, 507358933, 657861945, 1678381017, 560487590, (nint)3516619604L, 975451694,
    (nint)2970356327L, 261314535, (nint)3535072918L, (nint)2652609425L, 1333838021, (nint)2724322336L, 1767536459, 370938394,
    182621114, (nint)3854606378L, 1128014560, 487725847, 185469197, (nint)2918353863L, (nint)3106780840L, (nint)3356761769L,
    (nint)2237133081L, 1286567175, (nint)3152976349L, (nint)4255350624L, (nint)2683765030L, (nint)3160175349L, (nint)3309594171L, 878443390,
    1988838185, (nint)3704300486L, 1756818940, 1673061617, (nint)3403100636L, 272786309, 1075025698, 545572369,
    2105887268, (nint)4174560061L, 296679730, 1841768865, 1260232239, (nint)4091327024L, (nint)3960309330L, (nint)3497509347L,
    1814803222, (nint)2578018489L, (nint)4195456072L, 575138148, (nint)3299409036L, 446754879, (nint)3629546796L, (nint)4011996048L,
    (nint)3347532110L, (nint)3252238545L, (nint)4270639778L, 915985419, (nint)3483825537L, 681933534, 651868046, (nint)2755636671L,
    (nint)3828103837L, 223377554, (nint)2607439820L, 1649704518, (nint)3270937875L, (nint)3901806776L, 1580087799, (nint)4118987695L,
    (nint)3198115200L, 2087309459, (nint)2842678573L, (nint)3016697106L, 1003007129, (nint)2802849917L, 1860738147, 2077965243,
    164439672, (nint)4100872472L, 32283319, (nint)2827177882L, 1709610350, 2125135846, 136428751, (nint)3874428392L,
    (nint)3652904859L, (nint)3460984630L, (nint)3572145929L, (nint)3593056380L, (nint)2939266226L, 824852259, 818324884, (nint)3224740454L,
    930369212, (nint)2801566410L, (nint)2967507152L, 355706840, 1257309336, (nint)4148292826L, 243256656, 790073846,
    (nint)2373340630L, 1296297904, 1422699085, (nint)3756299780L, (nint)3818836405L, 457992840, (nint)3099667487L, 2135319889,
    77422314, 1560382517, 1945798516, 788204353, 1521706781, 1385356242, 870912086, 325965383,
    (nint)2358957921L, 2050466060, (nint)2388260884L, (nint)2313884476L, (nint)4006521127L, 901210569, (nint)3990953189L, 1014646705,
    1503449823, 1062597235, 2031621326, (nint)3212035895L, (nint)3931371469L, 1533017514, 350174575, (nint)2256028891L,
    (nint)2177544179L, 1052338372, 741876788, 1606591296, 1914052035, 213705253, (nint)2334669897L, 1107234197,
    1899603969, (nint)3725069491L, (nint)2631447780L, (nint)2422494913L, 1635502980, 1893020342, 1950903388, 1120974935
}.array();

internal static array<uint32> td2 = new uint32[]{
    (nint)2807058932L, 1699970625, (nint)2764249623L, 1586903591, 1808481195, 1173430173, 1487645946, 59984867,
    (nint)4199882800L, 1844882806, 1989249228, 1277555970, (nint)3623636965L, (nint)3419915562L, 1149249077, (nint)2744104290L,
    1514790577, 459744698, 244860394, (nint)3235995134L, 1963115311, (nint)4027744588L, (nint)2544078150L, (nint)4190530515L,
    1608975247, (nint)2627016082L, 2062270317, 1507497298, (nint)2200818878L, 567498868, 1764313568, (nint)3359936201L,
    (nint)2305455554L, 2037970062, 1047239000, 1910319033, 1337376481, (nint)2904027272L, (nint)2892417312L, 984907214,
    1243112415, 830661914, 861968209, 2135253587, 2011214180, (nint)2927934315L, (nint)2686254721L, 731183368,
    1750626376, (nint)4246310725L, 1820824798, (nint)4172763771L, (nint)3542330227L, 48394827, (nint)2404901663L, (nint)2871682645L,
    671593195, (nint)3254988725L, 2073724613, 145085239, (nint)2280796200L, (nint)2779915199L, 1790575107, (nint)2187128086L,
    472615631, (nint)3029510009L, (nint)4075877127L, (nint)3802222185L, (nint)4107101658L, (nint)3201631749L, 1646252340, (nint)4270507174L,
    1402811438, 1436590835, (nint)3778151818L, (nint)3950355702L, (nint)3963161475L, (nint)4020912224L, (nint)2667994737L, 273792366,
    (nint)2331590177L, 104699613, 95345982, (nint)3175501286L, (nint)2377486676L, 1560637892, (nint)3564045318L, 369057872,
    (nint)4213447064L, (nint)3919042237L, 1137477952, (nint)2658625497L, 1119727848, (nint)2340947849L, 1530455833, (nint)4007360968L,
    172466556, 266959938, 516552836, 0, (nint)2256734592L, (nint)3980931627L, 1890328081, 1917742170,
    (nint)4294704398L, 945164165, (nint)3575528878L, 958871085, (nint)3647212047L, (nint)2787207260L, 1423022939, 775562294,
    1739656202, (nint)3876557655L, (nint)2530391278L, (nint)2443058075L, (nint)3310321856L, 547512796, 1265195639, 437656594,
    (nint)3121275539L, 719700128, (nint)3762502690L, 387781147, 218828297, (nint)3350065803L, (nint)2830708150L, (nint)2848461854L,
    428169201, 122466165, (nint)3720081049L, 1627235199, 648017665, (nint)4122762354L, 1002783846, 2117360635,
    695634755, (nint)3336358691L, (nint)4234721005L, (nint)4049844452L, (nint)3704280881L, (nint)2232435299L, 574624663, 287343814,
    612205898, 1039717051, 840019705, (nint)2708326185L, 793451934, 821288114, 1391201670, (nint)3822090177L,
    376187827, (nint)3113855344L, 1224348052, 1679968233, (nint)2361698556L, 1058709744, 752375421, (nint)2431590963L,
    1321699145, (nint)3519142200L, (nint)2734591178L, 188127444, (nint)2177869557L, (nint)3727205754L, (nint)2384911031L, (nint)3215212461L,
    (nint)2648976442L, (nint)2450346104L, (nint)3432737375L, 1180849278, 331544205, (nint)3102249176L, (nint)4150144569L, (nint)2952102595L,
    (nint)2159976285L, (nint)2474404304L, 766078933, 313773861, (nint)2570832044L, 2108100632, 1668212892, (nint)3145456443L,
    2013908262, 418672217, (nint)3070356634L, (nint)2594734927L, 1852171925, (nint)3867060991L, (nint)3473416636L, (nint)3907448597L,
    (nint)2614737639L, 919489135, 164948639, 2094410160, (nint)2997825956L, 590424639, (nint)2486224549L, 1723872674,
    (nint)3157750862L, (nint)3399941250L, (nint)3501252752L, (nint)3625268135L, (nint)2555048196L, (nint)3673637356L, 1343127501, (nint)4130281361L,
    (nint)3599595085L, (nint)2957853679L, 1297403050, 81781910, (nint)3051593425L, (nint)2283490410L, 532201772, 1367295589,
    (nint)3926170974L, 895287692, 1953757831, 1093597963, 492483431, (nint)3528626907L, 1446242576, 1192455638,
    1636604631, 209336225, 344873464, 1015671571, 669961897, (nint)3375740769L, (nint)3857572124L, (nint)2973530695L,
    (nint)3747192018L, 1933530610, (nint)3464042516L, 935293895, (nint)3454686199L, (nint)2858115069L, 1863638845, (nint)3683022916L,
    (nint)4085369519L, (nint)3292445032L, 875313188, 1080017571, (nint)3279033885L, 621591778, 1233856572, (nint)2504130317L,
    24197544, (nint)3017672716L, (nint)3835484340L, (nint)3247465558L, (nint)2220981195L, (nint)3060847922L, 1551124588, 1463996600
}.array();

internal static array<uint32> td3 = new uint32[]{
    (nint)4104605777L, 1097159550, 396673818, 660510266, (nint)2875968315L, (nint)2638606623L, (nint)4200115116L, (nint)3808662347L,
    821712160, 1986918061, (nint)3430322568L, 38544885, (nint)3856137295L, 718002117, 893681702, 1654886325,
    (nint)2975484382L, (nint)3122358053L, (nint)3926825029L, (nint)4274053469L, 796197571, 1290801793, 1184342925, (nint)3556361835L,
    (nint)2405426947L, (nint)2459735317L, 1836772287, 1381620373, (nint)3196267988L, 1948373848, (nint)3764988233L, (nint)3385345166L,
    (nint)3263785589L, (nint)2390325492L, 1480485785, (nint)3111247143L, (nint)3780097726L, (nint)2293045232L, 548169417, (nint)3459953789L,
    (nint)3746175075L, 439452389, 1362321559, 1400849762, 1685577905, 1806599355, (nint)2174754046L, 137073913,
    1214797936, 1174215055, (nint)3731654548L, 2079897426, 1943217067, 1258480242, 529487843, 1437280870,
    (nint)3945269170L, (nint)3049390895L, (nint)3313212038L, 923313619, 679998000, (nint)3215307299L, 57326082, 377642221,
    (nint)3474729866L, 2041877159, 133361907, 1776460110, (nint)3673476453L, 96392454, 878845905, (nint)2801699524L,
    777231668, (nint)4082475170L, (nint)2330014213L, (nint)4142626212L, (nint)2213296395L, 1626319424, 1906247262, 1846563261,
    562755902, (nint)3708173718L, 1040559837, (nint)3871163981L, 1418573201, (nint)3294430577L, 114585348, 1343618912,
    (nint)2566595609L, (nint)3186202582L, 1078185097, (nint)3651041127L, (nint)3896688048L, (nint)2307622919L, 425408743, (nint)3371096953L,
    2081048481, 1108339068, (nint)2216610296L, 0, (nint)2156299017L, 736970802, 292596766, 1517440620,
    251657213, (nint)2235061775L, (nint)2933202493L, 758720310, 265905162, 1554391400, 1532285339, 908999204,
    174567692, 1474760595, (nint)4002861748L, (nint)2610011675L, (nint)3234156416L, (nint)3693126241L, 2001430874, 303699484,
    (nint)2478443234L, (nint)2687165888L, 585122620, 454499602, 151849742, (nint)2345119218L, (nint)3064510765L, 514443284,
    (nint)4044981591L, 1963412655, (nint)2581445614L, 2137062819, 19308535, 1928707164, 1715193156, (nint)4219352155L,
    1126790795, 600235211, (nint)3992742070L, (nint)3841024952L, 836553431, 1669664834, (nint)2535604243L, (nint)3323011204L,
    1243905413, (nint)3141400786L, (nint)4180808110L, 698445255, (nint)2653899549L, (nint)2989552604L, (nint)2253581325L, (nint)3252932727L,
    (nint)3004591147L, 1891211689, (nint)2487810577L, (nint)3915653703L, (nint)4237083816L, (nint)4030667424L, 2100090966, 865136418,
    1229899655, 953270745, (nint)3399679628L, (nint)3557504664L, (nint)4118925222L, 2061379749, (nint)3079546586L, (nint)2915017791L,
    983426092, 2022837584, 1607244650, 2118541908, (nint)2366882550L, (nint)3635996816L, 972512814, (nint)3283088770L,
    1568718495, (nint)3499326569L, (nint)3576539503L, 621982671, (nint)2895723464L, 410887952, (nint)2623762152L, 1002142683,
    645401037, 1494807662, (nint)2595684844L, 1335535747, (nint)2507040230L, (nint)4293295786L, (nint)3167684641L, 367585007,
    (nint)3885750714L, 1865862730, (nint)2668221674L, (nint)2960971305L, (nint)2763173681L, 1059270954, (nint)2777952454L, (nint)2724642869L,
    1320957812, (nint)2194319100L, (nint)2429595872L, (nint)2815956275L, 77089521, (nint)3973773121L, (nint)3444575871L, (nint)2448830231L,
    1305906550, (nint)4021308739L, (nint)2857194700L, (nint)2516901860L, (nint)3518358430L, 1787304780, 740276417, 1699839814,
    1592394909, (nint)2352307457L, (nint)2272556026L, 188821243, 1729977011, (nint)3687994002L, 274084841, (nint)3594982253L,
    (nint)3613494426L, (nint)2701949495L, (nint)4162096729L, 322734571, (nint)2837966542L, 1640576439, 484830689, 1202797690,
    (nint)3537852828L, (nint)4067639125L, 349075736, (nint)3342319475L, (nint)4157467219L, (nint)4255800159L, 1030690015, 1155237496,
    (nint)2951971274L, 1757691577, 607398968, (nint)2738905026L, 499347990, (nint)3794078908L, 1011452712, 227885567,
    (nint)2818666809L, 213114376, (nint)3034881240L, 1455525988, (nint)3414450555L, 850817237, 1817998408, (nint)3092726480L
}.array();

} // end aes_package
